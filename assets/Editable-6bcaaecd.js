import{c as y,R as d,j as a}from"./index-645f66d1.js";import{m as w,I as N,n as C}from"./makeData-fac34ded.js";import{f as g,a as f}from"./formatNumber-ebd4c37f.js";var v=y("x","IconX",[["path",{d:"M18 6l-12 12",key:"svg-0"}],["path",{d:"M6 6l12 12",key:"svg-1"}]]);const R=e=>a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"总计:"}),a.jsx("span",{children:g(e.table.getRowModel().rows.reduce((l,t)=>l+t.getValue(e.column.id),0),"decimal")})]}),j=e=>a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"小计:"}),g(e.getValue(),"decimal")]});function S(e){const{table:l,row:t,column:r,getValue:u}=e,c=u(),[n,i]=d.useState(c),o=()=>{var s,m,x,b,h,p;if(t.original[r.columnDef.accessorKey]!==n){if(Number(n)>1e3){(m=(s=l.options.meta)==null?void 0:s.setErrorRow)==null||m.call(s,{rowId:t.id,field:r.columnDef.accessorKey,errorMsg:"值不能大于1000"});return}else(b=(x=l.options.meta)==null?void 0:x.setErrorRow)==null||b.call(x,{rowId:t.id,field:r.columnDef.accessorKey,errorMsg:""});(p=(h=l.options.meta)==null?void 0:h.updateData)==null||p.call(h,{table:l,rowId:t.id,field:r.columnDef.accessorKey,value:n})}};return d.useEffect(()=>{i(c)},[c]),a.jsx("input",{className:"input input-ghost input-xs w-full",value:n,onChange:s=>i(s.target.value),onBlur:o,onClick:s=>s.stopPropagation()})}function D(e){const{table:l,row:t,column:r,getValue:u}=e,c=u(),[n,i]=d.useState(c),o=()=>{var s,m;t.original[r.columnDef.accessorKey]!==n&&((m=(s=l.options.meta)==null?void 0:s.updateData)==null||m.call(s,{table:l,rowId:t.id,field:r.columnDef.accessorKey,value:n==="男"?"m":"f"}))};return d.useEffect(()=>{i(c)},[c]),a.jsxs("select",{className:"select select-ghost select-xs w-full",value:n,onChange:s=>i(s.target.value),onBlur:o,onClick:s=>s.stopPropagation(),children:[a.jsx("option",{value:"男",children:"男"}),a.jsx("option",{value:"女",children:"女"})]})}const F=[{id:"ID",header:"ID",accessorKey:"id"},{header:"数据类型",columns:[{id:"枚举",size:100,minSize:100,accessorFn:e=>e.enum==="m"?"男":"女",accessorKey:"enum",meta:{align:"center",showFilterList:!0},filterFn:"equalsString",header:e=>a.jsx("span",{className:"text-secondary",children:"枚举"}),aggregatedCell:""},{id:"布尔",size:100,minSize:100,accessorFn:e=>e.boolean?"是":"否",accessorKey:"boolean",meta:{align:"center",showFilterList:!0},filterFn:"equalsString",cell:D,header:e=>a.jsx("span",{className:"text-secondary",children:"布尔"}),aggregatedCell:""},{id:"整数",meta:{align:"right"},accessorFn:e=>e.integer,header:e=>a.jsx("span",{className:"text-secondary",children:"整数"}),cell:e=>g(e.getValue(),"integer"),aggregatedCell:j,footer:R},{id:"数字百分比",accessorKey:"percent",meta:{align:"right"},header:e=>a.jsx("span",{className:"text-secondary",children:"数字百分比"}),cell:e=>g(e.getValue(),"percent"),aggregatedCell:""},{id:"数字",accessorKey:"number",meta:{align:"right"},header:e=>a.jsx("span",{className:"text-secondary",children:"数字"}),cell:e=>g(e.getValue(),"decimal"),aggregatedCell:j},{id:"字符串数字",accessorKey:"stringNumber",meta:{align:"right"},header:e=>a.jsx("span",{className:"text-secondary",children:"字符串数字"})},{id:"日期转字符串",accessorFn:e=>f(e.birthdate,"date"),meta:{align:"center"},header:e=>a.jsx("span",{className:"text-secondary",children:"日期"})},{id:"日期时间转字符串",accessorFn:e=>f(e.birthdate,"datetime"),meta:{align:"center"},header:e=>a.jsx("span",{className:"text-secondary",children:"日期时间"})},{id:"Date对象",accessorKey:"birthdate",header:e=>a.jsx("span",{className:"text-secondary",children:"Date对象"}),cell:e=>a.jsx("div",{className:"text-center",children:f(e.getValue(),"time")}),aggregatedCell:""}]},{header:"个人信息",columns:[{id:"姓名",accessorFn:e=>`${e.firstName}${e.lastName}`,header:"姓名"},{id:"年龄",accessorKey:"age",header:()=>"年龄",cell:S,aggregationFn:"mean",aggregatedCell:({getValue:e})=>a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"平均:"}),a.jsx("span",{children:Math.round(e()*100)/100})]})}]}],k={enableVirtualized:!1,enablePagination:!1,enableColumnReorder:!0,enableColumnResizing:!0,enableSorting:!0,enableTree:!1,enableGrouping:!1,enableFilters:!0,filterFromLeafRows:!1,enableHiding:!0,enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!1,enableClickRowSelection:!1,selectAllForAllPages:!1,enableCompactStyle:!0,enableStickyHeader:!0,enableAutoRowNumber:!1,enableExport:!0};function K(){const[e,l]=d.useState([]);d.useEffect(()=>{l(w(10))},[]);const t=d.useRef(null),r=()=>{t.current.addRow(C())},u=()=>{t.current.deleteRow()},c=()=>{try{const o=t.current.getChanges();console.log(o)}catch(o){i(o.message)}},[n,i]=d.useState("");return a.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col",children:[a.jsx("div",{className:"text-xs",children:"布尔列和年龄列允许编辑"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{className:"btn btn-primary btn-sm",onClick:r,children:"新增"}),a.jsx("button",{className:"btn btn-warning btn-sm",onClick:u,children:"删除"}),a.jsx("button",{className:"btn btn-info btn-sm",onClick:c,children:"保存"}),"(打开浏览器的开发工具(F12)的console中查看将要保存的数据)"]}),a.jsx(N,{ref:t,data:e,columns:F,getRowId:o=>o.id,...k}),a.jsx("div",{className:`toast toast-top toast-end ${n?"":"hidden"}`,children:a.jsx("div",{className:"alert alert-error",children:a.jsxs("div",{children:[a.jsx("button",{className:"btn btn-circle btn-xs",children:a.jsx(v,{size:16,onClick:()=>i("")})}),a.jsx("span",{children:n})]})})})]})}K.displayName="Editable";export{K as Component};
